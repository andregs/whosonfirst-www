<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <title>Missing the Point- GeoIP&rsquo;s, Points, Polygons, and a Precarious Farm in Kansas</title>
  <meta name="GENERATOR" content="Blackfriday Markdown Processor v2.0" />
  <meta charset="utf-8" />
</head>
<body>

<style type="text/css">
		body { font-family: serif; margin:2em; margin-left: 10%; margin-right: 10%; font-size: 1.3em; line-height: 1.5em; }
		img { max-width: 640px !important; max-height: 480px !important; border: 1px dotted #ccc; padding: .5em; margin: 0 auto; margin-bottom:1em; margin-top: 1em; }
	</style> <h2>Missing the Point- GeoIP's, Points, Polygons, and a Precarious Farm in Kansas</h2><p><iframe class="demo-wrapper" height="512px" width="90%" src="//tangrams.github.io/tangram-sandbox/tangram.html?styles/radar#4/38/-97"></iframe>
<p class = "caption">You Are Here (± 10,000 km)</p></p>

<p>There are few things more dangerous than an overconfident point when it&rsquo;s placed on a map. These sorts of points are intended to represent a place, like a house, a town, a city, or a country. But what happens when the thing not underneath that place is not that place (or is a fundamental misunderstanding of what that place is supposed to be)?</p>

<p>This past weekend, <a href="https://twitter.com/kashhill">Kashmir Hill</a> of <a href="https://fusion.net">Fusion</a> reported a <a href="https://fusion.net/story/287592/internet-mapping-glitch-kansas-farm/">terrifying story</a> that reflects the dark side of what happens when map data is misinterpreted and people are overconfident in what lies beneath that dot.</p>

<p>The story revolves around a small farm in Kansas that has been the victim of mistaken identity many times over. As Kashmir writes:
&gt; They’ve been accused of being identity thieves, spammers, scammers and fraudsters. They’ve gotten visited by FBI agents, federal marshals, IRS collectors, ambulances searching for suicidal veterans, and police officers searching for runaway children. They’ve found people scrounging around in their barn. The renters have been doxxed, their names and addresses posted on the internet by vigilantes. Once, someone left a broken toilet in the driveway as a strange, indefinite threat.</p>

<p>And to get to the underlying cause of this horrible case of mistaken identity is rather common technology called GeoIP. GeoIP providers attempt to connect clusters of IP addresses to a geographic region. Sometimes, that can be fairly specific, down to the city, other times it can only link to a state or country. If Facebook has asked you if you have tried to log in from another country you haven&rsquo;t visited, or a map that centers on your town by default, this is likely the technology that makes that possible. Sometimes, though, it centers on the wrong place, like when dial-up AOL had all their IP addresses coming from northern Virginia.</p>

<p>MaxMind, the most prominent GeoIP provider, only intended to give back the &ldquo;general area&rdquo; the IP address is in; not to indicate that the precise location lay beneath the pin. But that&rsquo;s exactly what many of the users of MaxMind&rsquo;s users have assumed that the data indicated. Which meant that any IP address that&rsquo;s known to be &ldquo;Somewhere in America&rdquo; (but can&rsquo;t be pinpointed to a specific city or state), MaxMind pointed right at this family farm. In some cases, these GeoIP leads can be useful, but when it all gets boiled down to <em>that point</em>, the nuance is often lost. And that can have drastic repercussions.</p>

<p>Part of the reason we&rsquo;re writing this is to point out that we have <a href="https://whosonfirst.mapzen.com/mmdb">our own project to augment the MaxMind GeoIP database</a> with data from <a href="https://whosonfirst.mapzen.com/">Who&rsquo;s On First</a> to interpret the results coming back from an IP lookup as a geographic area, and not a single point. Rather than sending back a point and some words saying where an IP address is location our modified version of the MaxMind database returns both a Who&rsquo;s on First ID and a bounding box (as well as its complete hierarchy) for that location. It means the United States is the container for the United States and that small town in Kansas is just that small town in Kansas. This is still an experimental project and we are working through the mechanics of what we store in the databases (we could include complete polygons but that might makes things a bit&hellip; heavy) and how often things get updated. As of this writing we haven&rsquo;t yet updated our databases to <a href="http://fusion.net/story/290772/ip-mapping-maxmind-new-us-default-location/">reflect the changes that MaxMind has made to their own data</a> yet.</p>

<p><img src="images/iamhere_iplookup.png" alt="screenshot" /></p>

<p>One of the other things this story has prompted us to do it finish up the work to enable IP lookups in <a href="https://mapzen.com/blog/iamhere/">the I Am Here project</a>. When enabled the code on <a href="https://whosonfirst.mapzen.com/iamhere">the I Am Here website</a> will try to use your computer&rsquo;s IP address and its corresponding location (using a <a href="https://whosonfirst.mapzen.com/mmdb/">Who&rsquo;s On First enabled MaxMind database</a>) to automatically position the map. Previously the map would always load centered on San Francisco&rsquo;s majestic <a href="https://www.flickr.com/people/spaceclaw/photosof/">Space Claw</a>&hellip; I mean Sutro Tower, which is great but a bit tiresome if don&rsquo;t live in San Francisco and always need to start using the website by zooming out to a different location.</p>

<p>The reason that we haven&rsquo;t enabled the IP lookup functionality sooner is because we noticed that sometimes when you load the website from a computer in San Francisco the map would automatically position itself in&hellip; you got it, Kansas. Now when you load <a href="https://whosonfirst.mapzen.com/iamhere/">I Am Here</a> for the first time you will see a modal dialog explaining that there are computers trying to be helpful, that sometimes their suggestions aren&rsquo;t very helpful and finally the option to tell the computers to stop helping you. Hopefully the computers will get it right more often than not and, because IP lookup is pretty cool when it works, there will be a way for people to use I Am Here without having to always start in San Francisco.</p>

<p>But this story, and <a href="http://fusion.net/story/214995/find-my-phone-apps-lead-to-wrong-home/">others</a> <a href="https://gimletmedia.com/episode/53-in-the-desert/">like it</a> should be a wake-up call to folks who design geospatial systems. When conveying ambiguity, it&rsquo;s hard to think how your users&rsquo; users will necessarily interpret the thing. And while longitude and latitude are ubiquitous, they&rsquo;re not always right to send along the context involved.</p>

<p>MaxMind has <a href="http://fusion.net/story/290772/ip-mapping-maxmind-new-us-default-location/">already taken some corrective steps</a> by changing the point that represents America from the farm at [38,-97] to the center of a nearby lake, but it still doesn&rsquo;t address the necessary issue of conveying how big a place match may be.</p>

<p>But to them, and to you, please: Consider the polygon.</p>

</body>
</html>
