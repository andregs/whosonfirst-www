<h1>whosonfirst-placetypes</h1> <p>Where things are (and what they mean) in Who's On First</p> <h2>Roles</h2> <p>For any hierarchy of place types we have identified three “roles” that any one of those place types can fall into. That doesn't mean there can't be others (roles or place types) only that these are the ones we've identified as a good place to start.</p> <h4>Common (C)</h4> <p>These are, well, common across <em>any</em> hierarchy for any place in Who's On First.</p> <p>This part is important: It means that at some point every single record shares at least one or more common ancestors (for example a country or a continent or occasionally just the Earth). That doesn't preclude very specific additions to the hierarchy for a given location only that those additions need to fit within a common hierarchy shared across all locations.</p> <h4>Common-optional (CO)</h4> <p>These are meant to be part of a common hierarchy but may not be present because they aren't relevant or because we don't have the data. Counties are a good example of this.</p> <h4>Optional (O)</h4> <p>These are the parts of a hierarchy specific, typically, to a country or region. For example, the many nested "/images/placetypes-latest.png" alt="" style="max-width:100%;"></a></p> <p><em>This image was generated using the <a href="https://github.com/whosonfirst/py-mapzen-whosonfirst-placetypes/blob/master/scripts/wof-graph-placetypes">handy wof-graph-placetypes script in the py-mapzen-whosonfirst-placetypes library</a></em></p> <h2>Placetypes</h2> <p>All place types have a unique 64-bit numeric ID. It should always be possible to query or filter for places by that numeric ID so that the burden of remembering whether it is <code>neighbourhood</code> or <code>neighborhood</code> or <code>quartier</code> or whatever is reserved for friendly banter over drinks.</p> <p>In alphabetical order the current list of placetypes in Who's On First is:</p> <h3>address</h3> <p><code>102312329</code></p> <p>This is an open question. The question being: How/what do we do with OpenAddresses? We aren't sure of anything, yet, except maybe to put this here as a placeholder for probably between buildings and venues</p> <p>Addresses are considered <code>common optional</code>.</p> <h3>building</h3> <p><code>102312327</code></p> <p>See also: <a href="https://builtworksregistry.wordpress.com/imagining-the-built-works-registry-by-aaron-straup-cope-christine-kuan/">Imagining the Built Works Registry</a></p> <p>Buildings are considered <code>common optional</code>.</p> <h3>campus</h3> <p><code>102312331</code></p> <p>Things like universities or office complexes and <a href="https://github.com/whosonfirst/whosonfirst-data/blob/master/meta/wof-campus-latest.csv">airports</a>. Something something something, Burning Man and other annual events.</p> <p>Campuses are considered <code>common optional</code>.</p> <h3>continent</h3> <p><code>102312309</code></p> <p>I think we're all in pretty broad agreement about continents, yeah?</p> <p>Continents are considered <code>common</code>.</p> <h3>country</h3> <p><code>102312307</code></p> <p>Basically places that issue passports, notwithstanding the details (like empires which actually issue the passports...)</p> <p>Continents are considered <code>common</code>.</p> <h3>county</h3> <p>This needs a better - that is more abstract - name. Like "region" instead of state, province, whatever... but for counties.</p> <p>Counties are considered <code>common optional</code>.</p> <h3>dependency</h3> <p><code>102312313</code></p> <p>It's not a sub-region of a country but rather dependent on a parent country for defence, passport control, subsidies, etc.</p> <p>Dependencies are considered <code>common optional</code>.</p> <h3>disputed</h3> <p><code>102322043</code></p> <p>Places that one or more parties claim as their own. As of this writing <em>all</em> disputed places are parented only by the country (and higher) IDs of the claimants. This isn't to say there aren't more granular hierarchies to be applied to these place only that we are starting with the simple stuff first.</p> <p>Disputed areas are considered <code>common optional</code>.</p> <h3>empire</h3> <p><code>102312335</code></p> <p>Or "sovereignty" but really... empire. For example the Meta United States that contains both the US and Puerto Rico.</p> <p>Empires are considered <code>common optional</code>.</p> <h3>localadmin</h3> <p><code>404221409</code></p> <p>In many countries, the lowest level of government. They contain one or more localities (or "populated places") which themselves have no authority. Often but not exclusively found in Europe.</p> <p>Localadmins are considered <code>common optional</code></p> <h3>locality</h3> <p><code>102312317</code></p> <p>Towns and cities, independent of size or population. Things with neighbourhoods, basically.</p> <p>Localities are considered <code>common</code>.</p> <h3>macrocounty</h3> <p><code>404221413</code></p> <p>Bundles of counties!</p> <p>Macrocounties are considered <code>optional</code>. These exists mostly in Europe.</p> <h3>macrohood</h3> <p><code>102312323</code></p> <p>Like "BoCoCa" which in WOE is a neighbourhood that parents another... neighbourhood.</p> <p>Macrohoods are considered <code>optional</code>.</p> <h3>macroregion</h3> <p><code>404221411</code></p> <p>Bundles of regions! These exists mostly in Europe.</p> <p>Macroregions are considered <code>optional</code>.</p> <h3>marinearea</h3> <p><code>404528655</code></p> <p>Places with fish and boats.</p> <p>Marine areas are considered <code>common_optional</code>.</p> <h3>metroarea</h3> <p><code>102371933</code></p> <p>Things like "The Bay Area" – this one is hard so we shouldn't spend too much time worrying about the details yet but instead treat as something we want to do eventually.</p> <p>Metropolitain areas are considered <code>common optional</code>.</p> <h3>microhood</h3> <p><code>102312321</code></p> <p>Because all place is disputed. And everyone has a name for a place that will offend someone else.</p> <p>Microhoods are considered <code>optional</code>.</p> <h3>neighbourhood</h3> <p><code>102312319</code></p> <p>Things no one will agree on. Ever.</p> <p>Neighbourhoods are considered <code>common</code>.</p> <h3>ocean</h3> <p><code>404528653</code></p> <p>The really big marine areas. The ones that you sometimes feel cast adrift on...</p> <p>Oceans are considered <code>common_optional</code>.</p> <h3>planet</h3> <p><code>102312341</code></p> <p>The big round thing you're standing on.</p> <h3>region</h3> <p><code>102312311</code></p> <p>States, provinces, regions. We call them <code>regions</code>. These are places that would have a bone in a "<a href="https://en.wikipedia.org/wiki/States'_rights">states rights</a>" argument.</p> <p>Regions are considered <code>common</code>.</p> <h3>venue</h3> <p><code>102312325</code></p> <p>Things with walls, often but mostly things that people stand around <em>together</em>. Things with walls  might be public (a bar) or private (your apartment) by default.</p> <p>Venues are considered <code>common optional</code>.</p> <h2>ISO Country codes</h2> <p>Per the ISO 3166 spec which states:</p> <pre><code>User-assigned code elements are codes at the disposal of users who need to add further names of countries, territories, or other geographical entities to their in-house application of ISO 3166-1, and the ISO 3166/MA will never use these codes in the updating process of the standard. The following codes can be user-assigned:[19]      Alpha-2: AA, QM to QZ, XA to XZ, and ZZ     Alpha-3: AAA to AAZ, QMA to QZZ, XAA to XZZ, and ZZA to ZZZ     Numeric: 900 to 999 </code></pre> <p>We use the following ISO country codes:</p> <h3>XK</h3> <p>We just followed <a href="https://geonames.wordpress.com/2010/03/08/xk-country-code-for-kosovo/">Geonames' lead</a> and have assigned <code>XK</code> to be the ISO country code for Kosovo.</p> <h3>XN</h3> <p>For <a href="http://www.nullisland.com/">Null Island</a>.</p> <h3>XX</h3> <p><code>XX</code> denotes a place disputed by two or more (ISO) countries.</p> <h3>XY</h3> <p><code>XY</code> denotes an ISO country that has yet to be determined (by us). You might typically see this is a record for a freshly created place that hasn't been fully vetted or editorialized yet.</p> <h3>XZ</h3> <p><code>XZ</code> is the ISO country code equivalent of <code>wof:parent_id=-2</code> or <code>:shrug: the world is a complicated place</code>.</p> <h2>Hierarchies</h2> <p>A Who's On First (<code>wof:</code>) hierarchy is a list of dictionaries, which each item is a dictionary containing a full hierarchy. Like this:</p> <pre><code>"wof:hierarchy": [ 	{ "neighbourhood_id": 9997, "locality_id": 9997, "metro_id": 9998, "county_id": 9998, "region_id": 9998, "country_id": 9998, "continent_id": 9998 }, 	{ "neighbourhood_id": 9997, "locality_id: 9997, "metro_id": 9999, "county_id": 9999, "region_id": 9999, "country_id": 9999, "continent_id": 9999 } ] </code></pre> <p>See below for details and rationale.</p> <h3>How did we get here?</h3> <p><em>The following is a verbatim written exercise to work through the issue of how a hierarchy should be represented or, more specifically, how the potentially multiple hierarchies that a given place might encompass should be represented.</em></p> <p>Something something something as elements on the root <code>properties</code> dictionary. Like this:</p> <pre><code>{ 	"wof:neighbourhood_id": 9999, 	"wof:locality_id": 9999, 	"wof:county_id": 9999, 	"wof:region_id": 9999, 	"wof:country_id": 9999, 	"wof:continent_id": 9999 } </code></pre> <p>Something something something as a dictionary on the root <code>properties</code> dictionary. Like this:</p> <pre><code>"wof:hierarchy": { 	"neighbourhood_id": 9999, 	"locality_id": 9999, 	"county_id": 9999, 	"region_id": 9999, 	"country_id": 9999, 	"continent_id": 9999 } </code></pre> <p>This has the advantage of keeping all the hierarchy information in one place however it is left as an exercise to the user to enforce the actual order of the hierarchy since there is no way to be certain that <code>programming langage X</code> will ensure the ordering of the dictionary keys. We could define the hierarchy as a list of dictionaries which would allow to explicitly encode the parent for that node but those extra bytes in each record will add up fast when dealing with a global hierarchy. Like this:</p> <pre><code>"wof:hierarchy": [ 	{ "neighbourhood_id": 9999, "parent": "locality_id" }, 	{ "locality_id": 9999, "parent: "county_id" }, 	{ "county_id": 9999, "parent": "region_id" }, 	{ "region_id": 9999, "parent": "country_id" }, 	{ "country_id": 9999, "parent": "continent_id" }, 	{ "continent_id": 9999, "parent": "" } } </code></pre> <p>Meanwhile we also know that we want to support certain place types that will have multiple parents (because geography) like metropolitain areas or, if we choose to include them in the gazetteer proper, road networks.</p> <p>At a minimum this means that some of the values for placetypes have to be lists which probably means <em>all</em> of the values should be lists so that people don't have to think about context or test data types. For example:</p> <pre><code>"wof:hierarchy": { 	"neighbourhood_id": [ 9999 ], 	"locality_id": [ 9999 ], 	"metropolitain_area": [ 9999 ], 	"county_id": [ 9999, 9999 ], 	"region_id": [ 9999 ], 	"country_id": [ 9999 ], 	"continent_id": [ 9999 ], } </code></pre> <p>However, it is possible to imagine a place type with not only multiple parents but multiple ancestors. A timezone or, again, a road network. In which case you find yourself with a dictionary whose values are lists of dictionaries. At which point you risk spiralling off in to Semantic Web graph theory quicksand.</p> <p>So maybe the thing to do is suffer mixed content (unique IDs and lists) where the rule is the immediate (outer) hierarchy stops the moment there are multiple parents. Like this:</p> <pre><code>"wof:hierarchy": { 	"neighbourhood_id": 9999, 	"locality_id": 9999, 	"metro_id": [ 		{ "metro_id": 9998, "county_id": 9998, "region_id": 9998, "country_id": 9998, "continent_id": 9998 }, 		{ "metro_id": 9999, "county_id": 9999, "region_id": 9999, "country_id": 9999, "continent_id": 9999 } 	] } </code></pre> <p>Or maybe the hierarchy is always just a list of dictionaries, each containing a full hierarchy. Like this:</p> <pre><code>"wof:hierarchy": [ 	{ "neighbourhood_id": 9997, "locality_id": 9997, "metro_id": 9998, "county_id": 9998, "region_id": 9998, "country_id": 9998, "continent_id": 9998 }, 	{ "neighbourhood_id": 9997, "locality_id: 9997, "metro_id": 9999, "county_id": 9999, "region_id": 9999, "country_id": 9999, "continent_id": 9999 } ] </code></pre> <p>Reasons why this last suggestion is good:</p> <ul> <li>It is explicit</li> <li>It is easy to compare multiple hierarchies</li> <li>It doesn't require the user do a lot of mental arithmetic to construct the complete hierarchy or to support whatever "efficiencies" we dream up in the moment</li> <li>It is easier to change going forward (say before an "official" launch) than the alternatives</li> </ul> <p>Reasons why this last suggestion is, or might be, bad:</p> <ul> <li>If we support metropolitain areas then many places (localities, neighbourhood, venues) may have multiple hierarchies where the only difference will (likely) be the county, leaving all the remaining ancestors in common</li> <li>File size, disk space and bandwidth - this is the corollary of the first point and akin to whitespace or coordinates with &gt; 6 decimal points in GeoJSON files</li> </ul> <p>In the end the "good" reasons outweighed the "bad" reasons.</p> <h2>See also</h2> <ul> <li><a href="https://github.com/whosonfirst/py-mapzen-whosonfirst-placetypes">https://github.com/whosonfirst/py-mapzen-whosonfirst-placetypes</a></li> </ul> 
