<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Who’s On First</title>
        <meta name='description' content="Who's on First is a gazetteer of places.">
        <link rel='apple-touch-icon' href='https://mapzen.com/common/styleguide/images/favicons/apple-touch-icon.png' sizes='180x180'>
        <link rel='icon' type='image/png' href='https://mapzen.com/common/styleguide/images/favicons/favicon-16x16.png' sizes='16x16'>
        <link rel='icon' type='image/png' href='https://mapzen.com/common/styleguide/images/favicons/favicon-32x32.png' sizes='32x32'>
        <link rel='manifest' href='https://mapzen.com/common/styleguide/images/favicons/manifest.json'>
        <link rel='mask-icon' href='https://mapzen.com/common/styleguide/images/favicons/safari-pinned-tab.svg' color='#2C1E3F'>
		
		<link rel="stylesheet" href="../css/bootstrap.min.css">
		<link rel="stylesheet" href="../css/mapzen.whosonfirst.css">
    </head>
	<body>
		<div class="whosonfirst-wrapper"><nav class="navbar navbar-default navbar-fixed-top whosonfirst-fixed-subpage-navbar">
	<div class="container">
		<!-- Brand and toggle get grouped for better mobile display -->
		<div class="navbar-header">
			<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
				<span class="sr-only">Toggle navigation</span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
			</button>
			<a class="navbar-brand" href="../index.html">Who's On First</a>
		</div>

		<!-- Collect the nav links, forms, and other content for toggling -->
		<div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
			<ul class="nav navbar-nav navbar-right">
				<li class="whosonfirst-navbar-element-collapsed">
					<a href="../data/index.html" class="whosonfirst-nav-link whosonfirst-nav-link-collapsed">data</a>
				</li>
				<li class="whosonfirst-navbar-element-collapsed">
					<a href="../docs/index.html" class="whosonfirst-nav-link whosonfirst-nav-link-collapsed">docs</a>
				</li>
				<li class="whosonfirst-navbar-element-collapsed">
					<a href="../tools/index.html" class="whosonfirst-nav-link whosonfirst-nav-link-collapsed">tools</a>
				</li>
				<li class="whosonfirst-navbar-element-collapsed">
					<a href="../blog/index.html" class="whosonfirst-nav-link whosonfirst-nav-link-collapsed">blog</a>
				</li>
				<li class="whosonfirst-navbar-element-collapsed">
					<a href="../getstarted/index.html" class="whosonfirst-nav-link whosonfirst-nav-link-collapsed whosonfirst-nav-active">get started</a>
				</li>
			</ul>
		</div><!-- /.navbar-collapse -->
	</div><!-- /.container-fluid -->
</nav><div class="container whosonfirst-subpage-container">
	<div class="row">
		<div class="col-lg-3 col-md-3 col-sm-3 col-xs-0">
			<aside>
				<div class="whosonfirst-sidenav-container">
					<ul class="whosonfirst-sidenav-list">
						<li class="whosonfirst-sidenav-list-element">
							<a href="../getstarted/retrievevenues.html" class="whosonfirst-nav-link whosonfirst-sidenav-link whosonfirst-nav-active">retrieve venues</a>
						</li>
					</ul>
				</div>
			</aside>
		</div>
		<div class="col-lg-7 col-md-9 col-sm-9 col-xs-12">
			<article><h1 class="whosonfirst-subpage-header">
Retrieve Venues
</h1>
<div class="whosonfirst-tabs-container">
	<div class="whosonfirst-tabs-subpage-menu whosonfirst-tabs-menu">
		<div class="whosonfirst-tabs-menu-content">
			<a class="whosonfirst-tab-selection whosonfirst-tab-selection-active" href="">
				api
			</a>
			<a class="whosonfirst-tab-selection" href="">
				html
			</a>
			<a class="whosonfirst-tab-selection" href="">
				personal copy
			</a>
		</div>
	</div>
	<div class="whosonfirst-extrasmall-tabs-menu">
		<div class="whosonfirst-extrasmall-tabs-menu-content">
			<div class="whosonfirst-extrasmall-tabs-menu-content-header">
				<div class="row whosonfirst-extrasmall-menu-row">
					<div class="col-xs-11">
						<div class="whosonfirst-extrasmall-tab-selection">Retrieve Venues</div>
					</div>
					<div class="col-xs-1 whosonfirst-extrasmall-menu-chevron-col">
						<button type="button" class="navbar-toggle collapsed whosonfirst-extrasmall-menu-chevron-down" data-toggle="collapse" data-target="#bs-example-navbar-collapse-2" aria-expanded="false">
							<span id="glyphicon-one" class="glyphicon glyphicon-menu-down whosonfirst-extrasmall-menu-actual-chevron-down"></span>
						</button>
					</div>
				</div>
			</div>
			<div class="collapse" id="bs-example-navbar-collapse-2">
				<div class="whosonfirst-extrasmall-nav-collection">
					<ul class="nav navbar-nav navbar-right whosonfirst-extrasmall-nav">
						<li class="whosonfirst-navbar-element-collapsed whosonfirst-extrasmall-nav-element">
							<a href="../getstarted/retrievevenues.html" class="whosonfirst-nav-link whosonfirst-extrasmall-nav-link-collapsed">retrieve venues</a>
						</li>
						<li class="whosonfirst-navbar-element-collapsed whosonfirst-extrasmall-nav-element">
							<a href="../getstarted/retrievevenues.html" class="whosonfirst-nav-link whosonfirst-extrasmall-nav-link-collapsed whosonfirst-nav-active whosonfirst-subnav-secondlevel">api</a>
						</li>
						<li class="whosonfirst-navbar-element-collapsed whosonfirst-extrasmall-nav-element">
							<a href="../getstarted/retrievevenues.html" class="whosonfirst-nav-link whosonfirst-extrasmall-nav-link-collapsed whosonfirst-extrasmall-nav-link-collapsed-last whosonfirst-subnav-secondlevel">personal copy</a>
						</li>
					</ul>
				</div>
			</div><!-- /.navbar-collapse -->
		</div>
	</div>
	<div class="whosonfirst-tabs-content"><p>
The Who’s On First API allows you to query and retrieve Who’s On First data including venue data via a REST-ish interface.
</p>
<p>
You can use the API to retrieve venues. Say you want to retrieve venues in New York City’s Flatiron District. In this tutorial you will:
</p>
<ol class="whosonfirst-content-list">
<li class="whosonfirst-content-list-item">
<a href="" class="whosonfirst-content-list-item-link">
Create
</a>
</li>
<li class="whosonfirst-content-list-item">
<a href="" class="whosonfirst-content-list-item-link">
Utilize Spelunker to find necessary information
</a>
</li>
<li class="whosonfirst-content-list-item">
<a href="" class="whosonfirst-content-list-item-link">
Retrieve data using the API
</a>
</li>
<li class="whosonfirst-content-list-item">
<a href="" class="whosonfirst-content-list-item-link">
Manipulate data
</a>
</li>
<li class="whosonfirst-content-list-item">
<a href="" class="whosonfirst-content-list-item-link">
Display results
</a>
</li>
</ol>
<h2 class="whosonfirst-subpage-subheader">
Step 1: Create a Map
</h2>
<p>
Utilize
<a href="">
mapzen.js
</a>
to make a map centered around New York City’s Flatiron District.
</p>
<pre>
&lt;title&gt;My Web Map&lt;/title&gt;&lt;/p&gt;
&lt;!DOCTYPE html&gt;
&lt;html lang=&#34;en&#34;&gt;
 &lt;head&gt;
  &lt;title&gt;My Web Map&lt;/title&gt;
  &lt;meta charset=&#34;utf-8&#34;&gt;
  &lt;link rel=&#34;stylesheet&#34; href=&#34;https://mapzen.com/js/mapzen.css&#34;&gt;
  &lt;script src=&#34;https://mapzen.com/js/mapzen.min.js&#34;&gt;&lt;/script&gt;
  &lt;style&gt;
   #map {
    height: 100%;
    width: 100%;
    position: absolute;
   }
   html,body {margin: 0; padding: 0;}
  &lt;/style&gt;
 &lt;/head&gt;
 &lt;body&gt;
  &lt;div id=&#34;map&#34;&gt;&lt;/div&gt;
  &lt;script&gt;
   L.Mapzen.apiKey = &#39;your-mapzen-api-key&#39;;
   var map = L.Mapzen.map(&#39;map&#39;);
   map.setView([37.7749, -122.4194], 12);
  &lt;/script&gt;
 &lt;/body&gt;
&lt;/html&gt;
</pre>
<p>
You will see a map that resembles the one below:
</p>
<img class="img-responsive whosonfirst-image-box" src="images/maptestimage.png">
<h2 class="">
Step 2: Utilize Spelunker to find necessary information
</h2>
<p>
Utilize the
<a href="">
WOF Spelunker
</a>
to look around the WOF database. The API’s methods are dispatched over HTTP with one or more query parameters, we can use the spelunker to find the parameters required to retrieve venues in the Flatiron District.
</p>
<p>
Use the Spelunker’s search and find the record corresponding to New York City. You will find this record.
</p>
<img class="img-responsive whosonfirst-image-box" src="images/maptestimage.png">
<p>
Find the 8 digit number followed by .geojson, for the Flatiron District that number is 85869245. 85869245 is the Flatiron District’s ID. You will use this when making the API call.
</p>
<h2 class="whosonfirst-subpage-subheader">
Step 3: Retrieve data using the API
</h2>
<p>
One of the available API methods is whosonfirst.places.getDescendants. The getDescendants method returns all the descendants for a Who’s On First ID. We have the Flatiron’s ID, so we can use this method.
</p>
<p>
We can also specify the specific placetype we want records to have. For this example, we can call
</p>
<pre>
curl -X GET &#39;https://whosonfirst-api.mapzen.com/?method=whosonfirst.places.getDescendants&amp;api_key=your-mapzen-api-key&amp;id=85869245&amp;placetype=venue&amp;per_page=500’
</pre>
<p>
This will retireve 500 venue descendants of the Flatiron District.
</p>
<h2 class="whosonfirst-subpage-subheader">
Step 4: Manipulate Data
</h2>
<p>
Manipulate the data in whatever manner you would like. If you want to display it on a map, you could implement this code.
</p>
<pre>
function runWhosOnFirstAPI() {
 // Setup the API key
<br>
mapzen.whosonfirst.api.set_handler(&#39;authentication&#39;, function() {
  return api_key;
 });
 // Get all the venues in the Flatiron District
 // See: https://mapzen.com/documentation/wof/methods/#whosonfirst.places.getDescendants
 var parent_id = randomLocation[2];
 var method = &#39;whosonfirst.places.getDescendants&#39;;
 var data = {
  id: parent_id,
  per_page: 500,
  extras: &#39;geom:&#39; // this gets us lat/lng coords
 };
 // Ok now we actually call the API
<br>
mapzen.whosonfirst.api.execute_method_paginated(method, data, onsuccess, onerror, onprogress);
<br>
document.getElementById(&#34;whosFirstDescendantKey&#34;).innerHTML = randomLocation[2];
<br>
document.getElementById(&#34;whosFirstDescendantLocation&#34;).innerHTML = randomLocation[4];};
</pre>
<h2 class="whosonfirst-subpage-subheader">
Step 5: Display Results
</h2>
<p>
Utilize the results whatever way you see fit, here we want to display the results on a map we do this with this function.
</p>
<pre>
var onprogress = function(rsp) {
 //console.log(rsp);
 for (var i = 0; i &lt; rsp.places.length; i++) {
  var place = rsp.places[i];
  show_venue(place);
 }
}
</pre>
<p>
You should now see a map that resembles the one below:
</p>
<img class="img-responsive whosonfirst-image-box" src="images/maptestimage.png">
<p>
This is only possible way you could use WOF. Explore our
<a href="">
API documentation
</a>
and
<a href="">
other tools
</a>
to discover other possible methods.
</p>
								</div>
							</div>
						</article>
					</div>
					<div class="col-lg-2 col-md-0 col-sm-0 col-xs-0"></div>
				</div>
			</div>
		</div>
		<footer>
			<nav class="navbar navbar-default navbar-bottom">
				<div class="container">
					<!-- Collect the nav links, forms, and other content for toggling -->
					<ul class="nav navbar-nav navbar-right whosonfirst-footer">
						<li class="whosonfirst-nav-link-nounderline whoosonfooter-gig">who's on first is a <a href="https://mapzen.com/" class="whosonfirst-nav-link whosonfirst-nav-link-innounderline">mapzen</a> gig</li>
						<li><a href="../docs/contributing/index.html" class="whosonfirst-nav-link whosonfirst-footer-nav-link">contributing</a></li>
						<li><a href="../docs/licensing/index.html" class="whosonfirst-nav-link whosonfirst-footer-nav-link">licensing</a></li>
						<li><a href="https://github.com/whosonfirst" class="whosonfirst-nav-link whosonfirst-footer-nav-link">code github</a></li>
						<li><a href="https://github.com/whosonfirst-data" class="whosonfirst-nav-link whosonfirst-footer-nav-link">data github</a></li>
						<li><a href="https://twitter.com/alloftheplaces/" class="whosonfirst-nav-link whosonfirst-footer-nav-link">twitter</a></li>
					</ul>
				</div>
			</nav>
		</footer>
		
		<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
		<!-- Include all compiled plugins (below), or include individual files as needed -->
		<script src="../javascript/bootstrap.min.js"></script>
		
		<script>
			$(document).ready(function(){
				$("#bs-example-navbar-collapse-2").on("show.bs.collapse", function(){
					console.log("In here");
					document.getElementById("glyphicon-one").classList.add("glyphicon-menu-up");
					document.getElementById("glyphicon-one").classList.remove("glyphicon-menu-down");
				});
				$("#bs-example-navbar-collapse-2").on("hide.bs.collapse", function(){
					document.getElementById("glyphicon-one").classList.add("glyphicon-menu-down");
					document.getElementById("glyphicon-one").classList.remove("glyphicon-menu-up");
				});
				$(".whosonfirst-sidenav-list").mouseover(function(){
					$("body").css("overflow","hidden");
				});
				$(".whosonfirst-sidenav-list").mouseout(function(){
					$("body").css("overflow","auto");
				});
			});
		</script>
	</body>
</html>