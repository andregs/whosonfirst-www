<?xml version="1.0"?>
<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>Who's On First - Alt. Geometries</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name='description' content="Who's on First is a gazetteer of places.">
        <link rel='apple-touch-icon' href='https://mapzen.com/common/styleguide/images/favicons/apple-touch-icon.png' sizes='180x180'>
        <link rel='icon' type='image/png' href='https://mapzen.com/common/styleguide/images/favicons/favicon-16x16.png' sizes='16x16'>
        <link rel='icon' type='image/png' href='https://mapzen.com/common/styleguide/images/favicons/favicon-32x32.png' sizes='32x32'>
        <link rel='manifest' href='https://mapzen.com/common/styleguide/images/favicons/manifest.json'>
        <link rel='mask-icon' href='https://mapzen.com/common/styleguide/images/favicons/safari-pinned-tab.svg' color='#2C1E3F'>

        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" type="text/css" href="../css/mapzen.whosonfirst.www.bundle.min.css"/>
        <link rel="stylesheet" href="https://mapzen.com/common/styleguide/styles/blog.css">
        <link rel="stylesheet" href="https://mapzen.com/js/mapzen.css">
        <link rel="stylesheet" href="../css/mapzenwhosonfirstsubpage.css">
        <script src="../javascript/mapzen.whosonfirst.www.bundle.min.js"></script>
    </head>
    <body>
        <nav class='navbar-default navbar-fixed-top custom-navbar no-nav' role='navigation'>
            <!--
            <div class='container'>
                <div class='navbar-header'>
                    <button type='button' class='navbar-toggle collapsed' data-toggle='collapse' data-target='#navbar-menu'>
                        <span class='sr-only'>Toggle navigation</span>
                        <span class='icon-bar top-bar'></span>
                        <span class='icon-bar middle-bar'></span>
                        <span class='icon-bar bottom-bar'></span>
                    </button>
                    <a class="navbar-brand custom-navbar-type custom-navbar-header" href="#">Who's On First</a>
                </div>
            <!-- new nav bar showing user's login status
                <div class='collapse navbar-collapse' id='navbar-menu'>
                    <ul class='nav navbar-nav navbar-right'>
                        <li class='inactive'><a href='https://whosonfirst.mapzen.com/theory/' class="custom-navbar-type">Theory</a></li>
                        <li class='inactive'><a href='https://whosonfirst.mapzen.com/data/' class="custom-navbar-type">Data</a></li>
                    </ul>
                    <!--
                    <ul class='nav navbar-nav navbar-right'>
                        <li class="inactive dropdown"><a id='sign-in' href='/developers/sign_in'> </a></li>
                        <li class="inactive"><a id='sign-up' href='/developers/sign_up'> </a></li>
                    </ul>
                </div>
            </div>
            -->
        </nav>
        <div class='section-nav' id='project-nav' role='navigation' aria-label='project-name'>
            <div class='container'>
                <div class='section-nav-container'>
                    <div class='section-nav-title'>
                        <h2 id='project-name'><a href='https://whosonfirst.mapzen.com'>Who's On First</a></h2>
                    </div>
                    <div class='section-nav-items'>
                        <ul class='section-nav-scroll-container'>
							<li id="nav-item-docs" class="section-nav-item active">
                                <a href="../docs/index.html">Docs</a>
                            </li>
                            <li id="nav-item-theory" class="section-nav-item">
                                <a href="https://whosonfirst.mapzen.com/theory/">Theory</a>
                            </li>
                            <li id="nav-item-data" class="section-nav-item">
                                <a href="https://whosonfirst.mapzen.com/data/">Data</a>
                            </li>
                            <li id="nav-item-bundles" class="section-nav-item">
                                <a href="https://whosonfirst.mapzen.com/bundles/">Bundles</a>
                            </li>
                            <li id="nav-item-placetypes" class="section-nav-item">
								<a href="https://whosonfirst.mapzen.com/placetypes/">Placetypes</a>
                            </li>
                        </ul>
                        <div class='section-nav-dropdown'>&#9698;</div>
                    </div>
                </div>
            </div>
        </div>
        <section class='container documentation-container'>
            <div class='row'>
                <!--
                <div class="col-xs-12 col-md-3">
                    <div class="toc toc-sub-left" role="directory">
                        <ul class="nav toc-nav">
                            <li class="toc-top-level">
                                <a href="https://whosonfirst.mapzen.com">Home</a>
                            </li>
                            <li class="toc-top-level">
                                <a href="https://whosonfirst.mapzen.com/bundles/">Bundles</a>
                                <ul class="toc-subnav">
                                    <li><a href="#placetypes">Placetypes</a></li>
                                    <li><a href="#working-with">Working with Bundles</a></li>
                                </ul>
                            </li>
                            <li class="toc-top-level">
                                <a href="https://whosonfirst.mapzen.com/data/">Data</a>
                                <ul class="toc-subnav">
                                    <li><a href="#theory-wrapper">tl;dr</a></li>
                                    <li><a href="#what-mean">But... what does it mean?</a></li>
                                    <li><a href="#gory-details">The gory details</a></li>
                                    <li><a href="#know-knows">Known knowns</a></li>
                                </ul>
                            </li>
                            <li class="toc-top-level">
                                <a href="https://whosonfirst.mapzen.com/interns/">Internships 2017</a>
                            </li>
                            <li class="toc-top-level">
                                <a href="https://whosonfirst.mapzen.com/mmdb/">Maxmind Databases (mmdb)</a>
                                <ul class="toc-subnav">
                                    <li><a href="#geolite2">GeoLite2 Databases</a></li>
                                    <li><a href="#code">Code</a></li>
                                </ul>
                            </li>
                            <li class="toc-top-level toc-current">
                                <a href="#">Placetypes</a>
                            </li>
                            <!--
                            <li class="toc-top-level">
                                <a href="https://whosonfirst.mapzen.com/theory/">Theory</a>
                                <ul class="toc-subnav">
                                    <li><a href="#theory-2015">2015</a></li>
                                    <li><a href="#theory-2016">2016</a></li>
                                    <li><a href="#theory-2017">2017</a></li>
                                </ul>
                            </li>
                            <li class="toc-top-level">
                                <a href="https://whosonfirst.mapzen.com/vagrant/">Vagrant</a>
                                <ul class="toc-subnav">
                                    <li><a href="#spelunker">spelunker.box</a></li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                </div>
                -->
                <div class='col-xs-12 col-md-10 col-md-offset-1 static-content'>
<article class="markdown-body entry-content" itemprop="text">
<h1>
<a id="user-content-what-is-an-alt-geometry-and-how-are-they-defined-and-catalogued-in-whos-on-first" class="anchor" href="#what-is-an-alt-geometry-and-how-are-they-defined-and-catalogued-in-whos-on-first" aria-hidden="true">
<svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16">
<path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z">
</path>
</svg>
</a>
What is an alt-geometry and how are they defined and catalogued in Who&#39;s On First?
</h1>
<p>
Each record in Who&#39;s On First has a point and/or a polygon geometry. San Francisco, for example, has a polygon geometry, stored in the 85922583.geojson file (
<a href="https://whosonfirst.mapzen.com/spelunker/id/85922583/">
here
</a>
).
This polygon geometry is the default geometry of San Francisco; a record&#39;s default geometry is in any geojson file that follows the following convention:
</p>
<p>
<code>
id.geojson
</code>
</p>
<p>
<em>
Example: 85922583.geojson
</em>
</p>
<p>
However, Who&#39;s On First also stores alt-geometry (alternate geometry) records. This not only allows Who&#39;s On First to maintain flexibility in record keeping, but also allows Who&#39;s On First to house geometries from a wide variety of sources. It also allows users and services to specify which geometry to use.
</p>
<h2>
<a id="user-content-what-rules-must-alt-geometries-follow" class="anchor" href="#what-rules-must-alt-geometries-follow" aria-hidden="true">
<svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16">
<path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z">
</path>
</svg>
</a>
What rules must alt-geometries follow?
</h2>
<p>
At a minimum, alt-geometry filenames must conform to the following convention:
</p>
<p>
<code>
id-alt-source.geojson
</code>
</p>
<p>
<em>
Example: 85922583-alt-mapzen.geojson
</em>
</p>
<p>
The
<code>
source
</code>
must be listed in the
<a href="https://github.com/whosonfirst/whosonfirst-sources">
<code>
whosonfirst-sources
</code>
</a>
repository. This is required record-keeping that allows any user or application to trace the origin of that geometry.
</p>
<p>
Alt-geometry records must include the following minimum set of properties:
</p>
<ul>
<li>
<strong>
id
</strong>
- The unique
<code>
wof:id
</code>
of the feature that this alt-geometry represents
</li>
<li>
<strong>
type
</strong>
- Should always equal
<code>
&#34;feature&#34;
</code>
</li>
<li>
<strong>
properties
</strong>
<ul>
<li>
<strong>
src:geom
</strong>
- The source of this alt-geometry. This source must be listed in the
<a href="https://github.com/whosonfirst/whosonfirst-sources">
<code>
whosonfirst-sources
</code>
</a>
repo
</li>
<li>
<strong>
wof:geomhash
</strong>
- The alpha-numeric geomhash code (more info
<a href="https://en.wikipedia.org/wiki/Geohash">
here
</a>
)
</li>
<li>
<strong>
wof:id
</strong>
- The unique
<code>
wof:id
</code>
of the feature that this alt-geometry represents
</li>
</ul>
</li>
<li>
<strong>
bbox
</strong>
- The bounding box coordinates of the alt-geometry feature
</li>
<li>
<strong>
geometry
</strong>
- The geometric coordinates of the alt-geometry feature
</li>
</ul>
<p>
An alt-geometry filename should always include the associated feature&#39;s
<code>
wof:id
</code>
, &#34;alt&#34;, and the source name (with dashes in between each value).
</p>
<h2>
<a id="user-content-what-optional-rules-apply-to-alt-geometries" class="anchor" href="#what-optional-rules-apply-to-alt-geometries" aria-hidden="true">
<svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16">
<path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z">
</path>
</svg>
</a>
What optional rules apply to alt-geometries?
</h2>
<p>
In addition to the above rules, an alt-geometry can also include &#34;use&#34;, &#34;scope&#34;, and &#34;detail&#34;. A filepath with such information would follow this convention:
</p>
<p>
<code>
id-alt-source-function-scope-detail.geojson
</code>
</p>
<p>
Where properties include:
</p>
<ul>
<li>
<strong>
source
</strong>
(eg:
<code>
uscensus
</code>
) – The source of this geometry, which should match a file in the
<code>
whosonfirst-sources
</code>
repository
</li>
<li>
<strong>
function
</strong>
that is intended (e.g.:
<code>
display
</code>
) – This could include:
<ul>
<li>
<strong>
search
</strong>
- For place by text (free or structured, e.g. forward geocoding) and getting back a (label) latitude/longitude, (label) bounding box, full geometry, and hints about &#34;hierarchy label&#34; generation.
</li>
<li>
<strong>
reverse geocode
</strong>
- For use of latitude/longitude to a place (preferring the &#34;biggest&#34; shape inclusive of territorial waters)
</li>
<li>
<strong>
data visualization
</strong>
(map
<strong>
display
</strong>
) - Based on polygon features (e.g. choropleth, with some sophistication around water and land parts, preferring the land parts)
</li>
<li>
<strong>
label basemap
</strong>
&#34;points&#34; (e.g.:
<code>
locality
</code>
townspots + text) and &#34;polygons&#34; (e.g.:
<code>
region
</code>
area text) - It&#39;s important to know which &#34;locality&#34; features
<code>
do not usually represent a single compact populated place
</code>
so their
<code>
mz:min_zoom
</code>
can be properly set, and we can choose the correct &#34;point&#34; or &#34;polygon&#34; labeling (and possibly switch between them at different zooms)
</li>
<li>
<strong>
showing boundary lines on a basemap
</strong>
(e.g.
<code>
region
</code>
boundary,
<code>
disputed
</code>
area boundaries, with some sophistication around water and land parts – e.g. option to not show territorial water parts, coastline parts, and/or inland water parts).
</li>
</ul>
</li>
<li>
<strong>
scope
</strong>
is level-of-scope (e.g.:
<code>
terrestrial
</code>
). This could include:
<ul>
<li>
<code>
territorial
</code>
- Default optimized for revGeo inclusive of all marine and territorial waters (no water clipping), understood that Mapzen may have modified the original, but it&#39;s still &#34;sourced&#34; to the source.
</li>
<li>
<code>
terrestrial
</code>
- Clipped to land + terrestrial waters (e.g. clipped to ocean coastline, but not punched thru for large inland water bodies), understood that Mapzen may have modified the original, but it&#39;s still &#34;sourced&#34; to the source. Used for most choropleth maps.
</li>
<li>
<code>
land
</code>
- No marine waters, no inland waters. Used in contexts where someone doesn&#39;t want to load separate &#34;earth&#34; base or &#34;water&#34; top layers.
</li>
<li>
<code>
marine
</code>
- Geometric opposite of terrestrial, useful for boundary lines.
</li>
</ul>
</li>
<li>
<strong>
detail
</strong>
is the level-of-detail (e.g.:
<code>
zoom-10
</code>
or
<code>
1024-px
</code>
)
</li>
</ul>
<p>
A filename with all of the above properties would look like the following example:
</p>
<ul>
<li>
<code>
85668127-alt-uscensus-display-terrestrial-zoom-10.geojson
</code>
</li>
</ul>
<p>
Permutations include:
</p>
<ul>
<li>
<code>
85668127-alt-uscensus.geojson
</code>
<em>
(common)
</em>
</li>
<li>
<code>
85668127-alt-uscensus-display.geojson
</code>
<em>
(common-optional)
</em>
</li>
<li>
<code>
85668127-alt-uscensus-display-terrestrial.geojson
</code>
<em>
(optional)
</em>
</li>
<li>
<code>
85668127-alt-uscensus-display-zoom-10.geojson
</code>
<em>
(optional)
</em>
</li>
<li>
<code>
85668127-alt-uscensus-display-1024-px.geojson
</code>
<em>
(optional)
</em>
</li>
<li>
<code>
85668127-alt-uscensus-display-terrestrial-zoom-10.geojson
</code>
<em>
(optional)
</em>
</li>
<li>
<code>
85668127-alt-uscensus-display-terrestrial-1024-px.geojson
</code>
<em>
(optional)
</em>
</li>
</ul>
<h2>
<a id="user-content-affects-to-the-default-geometry" class="anchor" href="#affects-to-the-default-geometry" aria-hidden="true">
<svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16">
<path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z">
</path>
</svg>
</a>
Affects to the default geometry
</h2>
<p>
If a default record in Who&#39;s On First has an alt-geometry record associated to it, the default record will have properties that point to it&#39;s associated alt-geometries. A snippet of these properties for the San Francisco example are shown below:
</p>
<pre>
<code>
&#34;src:geom_alt&#34;:[
        &#34;mapzen&#34;,
        &#34;alt-uscensus-display-zoom-10-original&#34;,
        &#34;alt-uscensus-display-terrestrial&#34;,
        &#34;alt-uscensus-display-zoom-10&#34;,
        &#34;alt-uscensus-display-1024-px&#34;,
        &#34;alt-uscensus-display-terrestrial-zoom-10&#34;
    ],
</code>
</pre>
<h2>
<a id="user-content-goals" class="anchor" href="#goals" aria-hidden="true">
<svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16">
<path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z">
</path>
</svg>
</a>
Goals
</h2>
<p>
Like most of Who&#39;s On First, this guideline is a work in progress and allows for future flexibility. We do not know every possible future use case for alt-geometries, but we can prepare for a variety of use cases by allowing flexibility and additions to the above rules.
</p>
<p>
Ideally, every feature in Who&#39;s On First will have at least two geometries; a default geometry that is some combination of simplification and file size and an alt-geometry that is either a source or display geometry.
</p>
<h2>
<a id="user-content-implementations" class="anchor" href="#implementations" aria-hidden="true">
<svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16">
<path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z">
</path>
</svg>
</a>
Implementations
</h2>
<ul>
<li>
<a href="https://github.com/whosonfirst/go-whosonfirst-uri">
Go
</a>
</li>
<li>
<a href="https://github.com/whosonfirst/js-mapzen-whosonfirst/blob/master/src/mapzen.whosonfirst.uri.js">
Javascript
</a>
</li>
<li>
<a href="https://github.com/whosonfirst/flamework-whosonfirst/blob/master/www/include/lib_whosonfirst_uri.php">
PHP
</a>
</li>
<li>
<a href="https://github.com/whosonfirst/py-mapzen-whosonfirst-uri">
Python
</a>
</li>
</ul>
<h2>
<a id="user-content-see-also" class="anchor" href="#see-also" aria-hidden="true">
<svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16">
<path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z">
</path>
</svg>
</a>
See also:
</h2>
<p>
<a href="https://github.com/whosonfirst/whosonfirst-geometries">
https://github.com/whosonfirst/whosonfirst-geometries
</a>
</p>
</article>
            	</div>
        	</div>
    	</section>
	</body>
    <footer>
        <div class='headroom-large custom-footer'>
            <div class='container'>
                <div class='row'>
                    <div class='col-xs-12 text-left custom-footer'>
                        <p>Who's On First is a <a href='https://mapzen.com/' class="custom-footer-actual-link">Mapzen</a> gig</p>
                        <p class="custom-footer-link custom-footer-first-link "><i class='fa fa-lg fa-fw fa-twitter'></i>Follow <a href='https://twitter.com/alloftheplaces/' class="custom-footer-actual-link">@alloftheplaces</a> on Twitter</p>
                        <p class="custom-footer-link"><i class='fa fa-lg fa-fw fa-github'></i>Check out our <a href='https://github.com/mapzen/' class="custom-footer-actual-link">whosonfirst</a> and <a href='https://github.com/whosonfirst-data/' class="custom-footer-actual-link">whosonfirst-data</a> organizations on Github</p>
                    </div>
                </div>
            </div>
        </div>
    </footer>
    
    <script src="../javascript/mapzen.whosonfirst.api.js"></script>
    <script src='../javascript/mapzen-styleguide.js'></script>
    <!--<script src='https://mapzen.com/common/styleguide/scripts/mapzen-styleguide.min.js'></script>-->
    <script src='https://code.jquery.com/jquery-2.2.0.min.js'></script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/jquery-scrollTo/2.1.0/jquery.scrollTo.min.js'></script>
</html>
